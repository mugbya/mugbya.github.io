---
layout: post
title: 三月更新问题及其解决办法
thread: 24
categories: archlinux
tags: netctl atombios
---

        环境：arch && 64bit

三个月没有更新系统，这次更新出现两个问题。
- 联网功能损坏，无法接入网络  
- 有关 atombios 的问题

对联网功能的损坏，日志信息描述如下：

        -- Unit netctl@wlp3s0\x2dtenda2.service has begun starting up.
        3月 20 21:29:36 arch network[2114]: Starting network profile 'wlp3s0-tenda2'...
        3月 20 21:29:36 arch network[2114]: The interface of network profile 'wlp3s0-tenda2' is already up
        3月 20 21:29:36 arch systemd[1]: netctl@wlp3s0\x2dtenda2.service: main process exited, code=exited, status=1/FAILURE
        3月 20 21:29:36 arch systemd[1]: Failed to start Networking for netctl profile wlp3s0-tenda2.
        -- Subject: Unit netctl@wlp3s0\x2dtenda2.service has failed
        -- Defined-By: systemd
        -- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel
        -- 
        -- Unit netctl@wlp3s0\x2dtenda2.service has failed.
        -- 
        -- The result is failed.
        3月 20 21:29:36 arch systemd[1]: Unit netctl@wlp3s0\x2dtenda2.service entered failed state.
        3月 20 21:29:36 arch sudo[2014]: pam_unix(sudo:session): session closed for user root  


查阅很多资料得知: 我的冗余操作而引起服务冲突了。  
如我无线是采用手动联网，先前的某些文件被我手动netctl启动了。但后面我又有启动自动连接功能。（至于为什么之前没有报出问题，我着实不怎么知道;也是通过这次的问题，才对联网功能有进一步的认识）

这次操作较久，终于解决了这个问题。我采用 netctl 管理网络连接

####wireless settings
对于无线，那么手动使配置文件生效，每次都需去手动连接;或者采用自动的方式：自动运行配置文件连接网络。

之前我一直都是采用手动的方式连接网络，但这次我改成自动连接（两者不要同时使用）
- 所谓同时使用指
	- netctl enable profile
    - systemctl enable netctl-auto@interface.service 

我把系统配置文件中的需要手动启动的文件全部删除。只剩下 netctl-auto@wlp3s0.service 这个服务留下。

配置文件路径： /etc/systemd/system/multi-user.target.wants

####wire settings
对于有线网络，因为我大多时候不会固定，所以也采用自动连接。如果你只使用一个单一的固定有线网络连接，并不需要网络管理服务的话，可使用简单的dhcpcd服务。不需要 netctl来管理有线。  
当采用netctl自动管理有线网络时，也须停止dhcpcd服务。如果之前启动过，在系统配置文件中也会有，进入到系统配置文件（上述的配置路径）将其删除。  
然后启用 systemctl enable netctl-ifplugd@interface_name.service 就ok了

我的目录下有如下一些配置（联网模块）：

    dnsmasq.service 
    netctl-auto@wlp3s0.service
    netctl-ifplugd@enp2s0.service

就这么简单几下配置，整个网络连接东西就OK.


对于第二个问题，错误日志描述如下：

    3月 22 16:10:12 arch kernel: [drm:atom_op_jump] *ERROR* atombios stuck in loop for more than 5secs aborting 
    3月 22 16:10:12 arch kernel: [drm:atom_execute_table_locked] *ERROR* atombios stuck executing CEBE (len 62, WS 0, PS 0) @ 0xCEDA
    3月 22 16:10:12 arch kernel: [drm:atom_execute_table_locked] *ERROR* atombios stuck executing BBBE (len 1036, WS 4, PS 0) @ 0xBCBB
    3月 22 16:10:12 arch kernel: [drm:atom_execute_table_locked] *ERROR* atombios stuck executing BB54 (len 76, WS 0, PS 8) @ 0xBB5C
    3月 22 16:10:14 arch kernel: radeon 0000:01:00.0: Wait for MC idle timedout !
    3月 22 16:10:14 arch kernel: radeon 0000:01:00.0: Wait for MC idle timedout !
    3月 22 16:10:14 arch kernel: [drm:r600_ring_test] *ERROR* radeon: ring 0 test failed (scratch(0x8504)=0xFFFFFFFF)
    3月 22 16:10:14 arch kernel: [drm:evergreen_resume] *ERROR* evergreen startup failed on resume
    3月 22 16:10:19 arch kernel: [drm:atom_op_jump] *ERROR* atombios stuck in loop for more than 5secs aborting
    3月 22 16:10:19 arch kernel: [drm:atom_execute_table_locked] *ERROR* atombios stuck executing C568 (len 1136, WS 0, PS 0) @ 0xC592
    3月 22 16:10:24 arch kernel: [drm:atom_op_jump] *ERROR* atombios stuck in loop for more than 5secs aborting
    3月 22 16:10:24 arch kernel: [drm:atom_execute_table_locked] *ERROR* atombios stuck executing CEBE (len 62, WS 0, PS 0) @ 0xCEDA
    3月 22 16:10:29 arch kernel: [drm:atom_op_jump] *ERROR* atombios stuck in loop for more than 5secs aborting
    3月 22 16:10:29 arch kernel: [drm:atom_execute_table_locked] *ERROR* atombios stuck executing CEBE (len 62, WS 0, PS 0) @ 0xCEDA
    3月 22 16:10:30 arch kernel: BUG: soft lockup - CPU#2 stuck for 23s! [X:398]


虽然有错误日志信息，但目前却仍旧没有找到解决之法，留之有空再来解决

- 首次编辑：2014-03-24


